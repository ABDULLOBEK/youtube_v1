package com.example.service;import com.example.dto.ApiResponse;import com.example.dto.PlaylistVideoDTO;import com.example.entity.PlaylistVideoEntity;import com.example.enums.Language;import com.example.repository.PlaylistVideoRepository;import com.example.util.SpringSecurityUtil;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import java.util.Optional;@Servicepublic class PlaylistVideoService {    @Autowired    private PlaylistVideoRepository playlistVideoRepository;    @Autowired    private ResourceBundleService resourceBundleService;    private PlaylistVideoDTO TO_DTO(PlaylistVideoEntity entity) {        PlaylistVideoDTO dto = new PlaylistVideoDTO();        dto.setPlaylistId(entity.getPlaylistId());        dto.setVideoId(entity.getVideoId());        dto.setId(entity.getId());        dto.setOrderNum(entity.getOrderNum());        return dto;    }    private PlaylistVideoEntity TO_ENTITY(PlaylistVideoDTO dto) {        PlaylistVideoEntity entity = new PlaylistVideoEntity();        entity.setVideoId(dto.getVideoId());        entity.setPlaylistId(dto.getPlaylistId());        entity.setOrderNum(dto.getOrderNum());        return entity;    }    public ApiResponse create(PlaylistVideoDTO dto) {        Integer prtId = SpringSecurityUtil.getCurrentProfileId();        PlaylistVideoEntity entity = TO_ENTITY(dto);        entity.setPrtId(prtId);        PlaylistVideoEntity saved = playlistVideoRepository.save(entity);        return new ApiResponse(true, TO_DTO(saved));    }    public ApiResponse update(Integer id, PlaylistVideoDTO dto, Language lang) {        Integer prtId = SpringSecurityUtil.getCurrentProfileId();        Optional<PlaylistVideoEntity> optionalPlaylistVideo = playlistVideoRepository.findById(id);        if (optionalPlaylistVideo.isPresent()) {            PlaylistVideoEntity entity = optionalPlaylistVideo.get();            if (entity.getPrtId().equals(prtId)) {                entity.setPlaylistId(dto.getPlaylistId());                entity.setVideoId(dto.getVideoId());                PlaylistVideoEntity updated = playlistVideoRepository.save(entity);                return new ApiResponse(true, TO_DTO(updated));            } else {                return new ApiResponse(false, resourceBundleService.getMessage("you.are.not.allowed", lang));            }        } else {            return new ApiResponse(false, resourceBundleService.getMessage("item.not.found", lang));        }    }    public ApiResponse delete(Integer id, Language lang) {        Integer prtId = SpringSecurityUtil.getCurrentProfileId();        Optional<PlaylistVideoEntity> optionalPlaylistVideo = playlistVideoRepository.findById(id);        if (optionalPlaylistVideo.isPresent()) {            PlaylistVideoEntity entity = optionalPlaylistVideo.get();            if (entity.getPrtId().equals(prtId)) {                playlistVideoRepository.deleteById(id);                return new ApiResponse(true, resourceBundleService.getMessage("success.deleted", lang));            } else {                return new ApiResponse(false, resourceBundleService.getMessage("you.are.not.allowed", lang));            }        } else {            return new ApiResponse(false, resourceBundleService.getMessage("item.not.found", lang));        }    }}